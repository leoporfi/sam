# ===== CONFIGURACIÓN GENERAL SAM =====

# --- Logging ---
LOG_DIRECTORY=C:/RPA/Logs/SAM
LOG_LEVEL=INFO
LOG_FORMAT=%(asctime)s - PID:%(process)d - %(levelname)s - %(name)s - %(funcName)s - %(message)s
LOG_DATEFMT=%Y-%m-%d %H:%M:%S
LOG_BACKUP_COUNT=7

# --- Archivos de log específicos ---
APP_LOG_FILENAME_LANZADOR=sam_lanzador_app.log
APP_LOG_FILENAME_BALANCEADOR=sam_balanceador_app.log
APP_LOG_FILENAME_CALLBACK=sam_callback_server.log
APP_LOG_FILENAME_INTERFAZ_WEB=sam_interfaz_web.log

# --- Base de Datos SAM ---
SQL_SAM_DRIVER={ODBC Driver 17 for SQL Server}
SQL_SAM_HOST=127.0.0.1
SQL_SAM_DB_NAME=SAM
SQL_SAM_UID=usuario_sam
SQL_SAM_PWD=password_sam
SQL_SAM_TIMEOUT_CONEXION_INICIAL=60
SQL_SAM_MAX_REINTENTOS_QUERY=3
SQL_SAM_DELAY_REINTENTO_QUERY_BASE_SEG=2
SQL_SAM_CODIGOS_SQLSTATE_REINTENTABLES=40001,HYT00,HYT01,08S01
SQL_SAM_POOL_SIZE=10

# --- Base de Datos RPA360 ---
SQL_RPA360_DRIVER={ODBC Driver 17 for SQL Server}
SQL_RPA360_HOST=127.0.0.1
SQL_RPA360_DB_NAME=RPA360
SQL_RPA360_UID=usuario_rpa360
SQL_RPA360_PWD=password_rpa360
SQL_RPA360_TIMEOUT_CONEXION_INICIAL=60
SQL_RPA360_MAX_REINTENTOS_QUERY=3
SQL_RPA360_DELAY_REINTENTO_QUERY_BASE_SEG=2
SQL_RPA360_POOL_SIZE=5

# --- Automation Anywhere ---
AA_CR_URL=https://controlroom.example.com
AA_CR_USER=usuario_aa
AA_CR_API_KEY=api_key_aa
AA_VERIFY_SSL=true
AA_API_TIMEOUT_SECONDS=200
AA_TOKEN_REFRESH_BUFFER_SEC=1140
AA_DEFAULT_PAGE_SIZE=100
AA_MAX_PAGINATION_PAGES=1000
AA_URL_CALLBACK="https://callback.example.com/api/callback"

# --- Callback Server ---
CALLBACK_SERVER_HOST=0.0.0.0
CALLBACK_SERVER_PORT=8008
CALLBACK_SERVER_THREADS=5
CALLBACK_ENDPOINT_PATH=/api/callback
CALLBACK_TOKEN=token_callback_seguro
CALLBACK_AUTH_MODE=optional

# --- Email ---
EMAIL_SMTP_SERVER=smtp.example.com
EMAIL_SMTP_PORT=25
EMAIL_FROM=sam@example.com
EMAIL_DESTINATARIOS=admin@example.com;soporte@example.com
EMAIL_USE_TLS=False

# --- Configuración Lanzador ---
LANZADOR_REPETICIONES_ROBOT=3
LANZADOR_INTERVALO_LANZAMIENTO_SEG=15
LANZADOR_INTERVALO_CONCILIACION_SEG=300
LANZADOR_INTERVALO_SINCRONIZACION_SEG=3600
LANZADOR_MAX_WORKERS=10
LANZADOR_MAX_REINTENTOS_DEPLOY=2
LANZADOR_DELAY_REINTENTO_DEPLOY_SEG=5
LANZADOR_PAUSA_INICIO_HHMM=21:00
LANZADOR_PAUSA_FIN_HHMM=21:15
LANZADOR_HABILITAR_SINCRONIZACION=false
LANZADOR_SHUTDOWN_TIMEOUT_SEG=60
LANZADOR_UMBRAL_ALERTAS_ERROR_412=20
LANZADOR_CONCILIADOR_TAMANO_LOTE=50
LANZADOR_CONCILIADOR_DIAS_TOLERANCIA_ESTADO_UNKNOWN=30
# Mensaje a guardar cuando se infiere finalización
LANZADOR_CONCILIADOR_MENSAJE_INFERIDO="Finalizado (Inferido por ausencia en lista de activos)"
LANZADOR_CONCILIADOR_MAX_INTENTOS_INFERENCIA=5


# --- Configuración Balanceador ---
BALANCEADOR_PERIODO_ENFRIAMIENTO_SEG=300
BALANCEADOR_INTERVALO_CICLO_SEG=120
BALANCEADOR_POOL_AISLAMIENTO_ESTRICTO=true
BALANCEADOR_PROVEEDORES_CARGA=clouders,rpa360
BALANCEADOR_TICKETS_PREDETERMINADOS_POR_EQUIPO=15

# Mapeo de robots (JSON)
MAPA_ROBOTS={"ROBOT_KEY": "NombreRobotA360"}

# --- Configuración API de Clouders ---
CLOUDERS_API_URL=https://api.clouders.example.com
CLOUDERS_AUTH=Basic token_base64
CLOUDERS_VERIFY_SSL=false
CLOUDERS_API_TIMEOUT=30

# --- Configuración Interfaz Web ---
INTERFAZ_WEB_HOST=127.0.0.1
INTERFAZ_WEB_PORT=8000
INTERFAZ_WEB_DEBUG=false
# INTERFAZ_WEB_SECRET_KEY=clave_secreta_muy_segura_cambiar_en_produccion
INTERFAZ_WEB_SESSION_TIMEOUT_MIN=30
INTERFAZ_WEB_MAX_UPLOAD_SIZE_MB=16
INTERFAZ_WEB_UMBRAL_EJECUCION_DEMORADA_MINUTOS=25
INTERFAZ_WEB_FACTOR_UMBRAL_DINAMICO=1.5
INTERFAZ_WEB_PISO_UMBRAL_DINAMICO_MINUTOS=10
INTERFAZ_WEB_FILTRO_EJECUCIONES_CORTAS_MINUTOS=2

# Credenciales A360 exclusivas para la Web (Evita conflicto de token con Lanzador)
INTERFAZ_WEB_AA_USER=usuario_aa_web
INTERFAZ_WEB_AA_APIKEY=api_key_aa_web

# --- Configuración del APIGW ---
API_GATEWAY_URL=https://gateway.example.com/token
API_GATEWAY_CLIENT_ID=client_id_gw
API_GATEWAY_CLIENT_SECRET=client_secret_gw
API_GATEWAY_SCOPE=scope_gw


# --- Configuración del Servidor de Autorización ---
AUTH_SERVER_HOST=0.0.0.0
AUTH_SERVER_PORT=5001
APIGW_CLIENT_ID=client_id_auth
APIGW_CLIENT_SECRET=client_secret_auth

# --- Configuración de JWT para SAM Callback ---
# Pega aquí la clave pública que genera el auth_server al iniciar.
# Debe estar entre comillas triples si tiene saltos de línea.
JWT_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA...
-----END PUBLIC KEY-----"

JWT_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQ...
-----END PRIVATE KEY-----"
JWT_AUDIENCE="sam-callback-service"
JWT_ISSUER="sam-auth-server"
